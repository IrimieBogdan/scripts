- job-group:
    name: 'clj-merge-unit'
    meta_path_jobgroup: 'resources/pipelines/unit-clj.yaml'
    jobs:
        - '{value_stream}_{name}_init-merge_{qualifier}':
            qualifier: 'full_{scm_branch}'
            dn-sort-index: ' 00:'
            tpb_projects: '{value_stream}_{name}_unit-clj_{scm_branch}'
        - '{value_stream}_{name}_unit-clj_{qualifier}':
             dn-sort-index: ' 01:'

- job-group:
    name: 'classifier-unit-pipeline'
    meta_path_jobgroup: 'resources/pipelines/unit-clj.yaml'
    jobs:
        - '{value_stream}_{name}_unit-clj_postgres-integration_{qualifier}':
            dn-sort-index: ' 01:'
            tpb_projects: '{value_stream}_classifier_unit-jruby_{scm_branch}'
            pgdb_password: 'classifier919'
            pgdb_user: 'classifier'

        - '{value_stream}_{name}_unit-jruby_{scm_branch}':
            dn-sort-index: ' 05:'
            tpb_projects: '{obj:downstream_jobs}'
            additional_exports: "export PUPPET_LOCATION='git://github.com/puppetlabs/puppet.git#{puppet_branch}'"

- job-group:
    name: 'rbac-unit-pipeline'
    meta_path_jobgroup: 'resources/pipelines/unit-clj.yaml'
    jobs:
        - '{value_stream}_{name}_unit-clj_{qualifier}':
            dn-sort-index: ' 01:'
            tpb_projects: '{value_stream}_{name}_unit-clj_directory-services_ad_{scm_branch}'
            clj_lein_test_selector: ':unit'

        - '{value_stream}_{name}_unit-clj_directory-services_{qualifier}':
            qualifier: 'ad_{scm_branch}'
            dn-sort-index: ' 05:'
            dn-qualifier: 'Integration (Active Directory)'
            ds_user: CN=Administrator,CN=Users,DC=delivery,DC=puppetlabs,DC=net
            ds_host: rudra.delivery.puppetlabs.net
            ds_pass: Vihoccyt1
            ds_cert: dev-resources/ssl/activedirectory/rudra.pem
            ds_type: activedirectory
            ds_group_dn: CN=Groups
            ds_user_dn: CN=Users
            ds_base_dn: DC=delivery,DC=puppetlabs,DC=net
            tpb_projects: '{value_stream}_{name}_unit-clj_directory-services_openldap_{scm_branch}'
            clj_lein_test_selector: ':integration'

        - '{value_stream}_{name}_unit-clj_directory-services_{qualifier}':
            qualifier: 'openldap_{scm_branch}'
            dn-sort-index: ' 06:'
            dn-qualifier: 'Integration (OpenLDAP)'
            ds_user: cn=admin,dc=delivery,dc=puppetlabs,dc=net
            ds_host: devi.delivery.puppetlabs.net
            ds_pass: puppet
            ds_cert: dev-resources/ssl/openldap/devi.pem
            ds_type: openldap
            ds_group_dn: ou=groups
            ds_user_dn: ou=users
            ds_base_dn: dc=delivery,dc=puppetlabs,dc=net
            tpb_projects: '{obj:downstream_jobs}'
            clj_lein_test_selector: ':integration'

- job-group:
    name: 'clj-merge-unit_postgres-integration'
    meta_path_jobgroup: 'resources/pipelines/unit-clj.yaml'
    jobs:
        - '{value_stream}_{name}_init-merge_{qualifier}':
            dn-sort-index: ' 00:'
            tpb_projects: '{value_stream}_{name}_unit-clj_postgres-integration_{scm_branch}'
        - '{value_stream}_{name}_unit-clj_postgres-integration_{qualifier}':
            qualifier: '{scm_branch}'
            dn-sort-index: ' 01:'
