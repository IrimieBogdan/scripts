# This defaults file contains both JJB variables and project configuration
# stanzas which apply to all jobs that do not have an alternate "defaults:"
# declaration.
#
# JJB variables are values that get interpolated into templates and shell
# scripts where ever that variable appears through  JJB yaml & shells scripts in
# the form of {varnam}.
#
# JJB project configuration is actual JJB declaration of some built-in Jenkins
# job feature or plugin and the attributes necessary to get the desired
# behavior our of that plugin/feature.
#
# In this file the distinction between "JJB variable" and "JJB project
# configuration" is made by the presence of a line comment with "# VAR" above
# the description of that variable.
#
- defaults:
    name: global
    project-type: freestyle

    scm:
        - git:
            url: '{git_url}'
            recursive-submodules: true
            branches:
                - '{scm_branch}'
            skip-tag: '{git-skip-tag}'
    git_excluded_regions: ''
    git_included_regions: ''
    scm_branch: ''
    qualifier: '{scm_branch}'

    logrotate:
        daysToKeep: '{logrotate_daystokeep}'
        numToKeep: '{logrotate_numtokeep}'

    # VAR
    # Default values for the logrotate feature. These values determine how many
    # builds to keep history for and how long each build history should be
    # tracked.
    #
    # Set to -1 to disable either either method of keeping builds around.
    #
    logrotate_daystokeep: 14
    logrotate_numtokeep: 14

    retry-count: 10
    quiet-period: 2

    wrappers:
        - timeout:
            timeout: '{console_timeout}'
            type: no-activity
            actions:
                - abort
        - ansicolor:
            colormap: xterm

    # VAR for ci-job-configs' trigger-parameterized-build publisher macro
    # Default predefined parameters for triggered job.
    # Probably most useful to set on a per job-template basis.
    tpb_predefined_parameters: ''

    # VAR for ci-job-configs' trigger-parameterized-build publisher macro
    # Default property file for triggered job.
    tpb_property_file: ''

    # VAR for ci-job-configs' trigger-parameterized-build publisher macro
    # Default current parameter passing behavior.
    tpb_current_parameters: True

    # VAR for ci-job-configs' trigger-parameterized-build publisher macro
    # Default condition under which to trigger downstream job. Note that JJB
    # doesn't care what value it receives for this field so be careful! Valid
    # values:
    #   - ALWAYS
    #   - SUCCESS
    #   - FAILED
    #   - UNSTABLE
    #   - UNSTABLE_OR_BETTER
    #   - UNSTABLE_OR_WORSE
    tpb_condition: 'UNSTABLE_OR_BETTER'

    # VAR for ci-job-configs' trigger-parameterized-build publisher macro
    # Default git revision passing behavior for downstream job.
    tpb_git_revision: True

    tpb_projects: ''

    # VAR
    # Default no-activity build timeout wrapper in seconds.
    console_timeout: '10'

    hipchat:
        enabled: true
        room: '{hipchat_room}'
        start-notify: true
        notify-success: true
        notify-aborted: true
        notify-not-built: true
        notify-failure: true
        notify-unstable: true
        notify-back-to-normal: true

    # VAR
    # Can be a comma-delimited list of hipchat room names. There should be no
    # spaces between comma and room names.
    hipchat_room: ''

    ###
    # Below are variables that would ideally belong to project or job-specific
    # defaults. However, with JJB's current design/implementation each job can
    # only have a single template and there is no such thing as template
    # inheritance.
    #

    # VAR
    # Deprecated variable used by ezbake packaging jobs to work around jankiness
    # with original ezbake design. This variable can be removed once EZ-14 is
    # finished and implemented in all relevant clojure projects.
    script_dir: ''

    # VAR
    # Used by shell scripts that call beaker to set a default --preserve-hosts
    # value. Being explicit about "never" ensures that staging/experimental jobs
    # and jobs that don't explicitly need to preserve hosts don't unnecessarily
    # consume vsphere resources.
    preserve_hosts: never

    # VAR
    # This variable is intended to be used in shell scripts to export additional
    # variables on a per-job or per-project basis. This allows changes to
    # individual jobs or projects that can be accomplished by exporting
    # environment variables that won't necessarily affect other jobs using the
    # same script.
    additional_exports: ''

    # VAR
    # Intended to be used in the display-name field of job templates to
    # distinguish multiple jobs reified from the same template from one another
    # when viewing in Jenkins Web UI
    dn-qualifier: ''

    # VAR
    # Intended to be used in the display-name field of job templates to help
    # sort jobs alphanumerically in Jenkins Web UI view.
    dn-sort-index: ''

    # VAR
    is-pe: ''

    # VAR
    # Used in the git-clone shell script to set a default for the GIT_REF
    # environment variable.
    git-branch: 'master'

    # VAR
    # Used to set default values for PE_VER job parameters when duplicating CI
    # pipelines for different PE versions. Non-PE jobs don't need this value set
    # so the default is empty string.
    default_PE_VER: ''

    # VAR
    # Used to add a command to run before frontend assets are built, but after
    # npm install has completed.
    assets-prebuild-cmd: ''

    # VAR
    # Used to add options to `bundler install` when running ruby unit tests
    unit-bundler-opts: ''

    # VAR
    # Used in shell scripts to set GEM_SOURCE, which is typically used in
    # project Gemfile to indicate where to look for ruby gems.
    gem_source: 'http://rubygems.delivery.puppetlabs.net'

    # VAR
    # Used in shell scripts to indicate default version of ruby to set with rvm.
    rvm_ruby_version: '1.9.3-p484'

    # VAR
    # Used in shell scripts to indicate default version of ruby to set with rvm.
    pe_family: ''

    # VAR
    # Used in packaging-clj-lein-ezbake-multiproject.sh to set a default
    # variable name for beaker presuites to pick up on when isntalling a
    # package built by releng jobs.
    package_build_version_varname: 'PACKAGE_BUILD_VERSION'

    # VAR
    # Used in kickoff jobs to set the value for the "disabled" field. Here we
    # ensure that kickoff jobs cannot be accidentally enabled.
    kickoff_disabled: True

    # VAR
    # Used to indicate that Jenkins shouldn't do its default stupid
    # tagging behavior
    git-skip-tag: False

    # VAR
    # Used in jobs that call 'rake pl:jenkins:uber_build' to conflicts between
    # simultaneous triggers of two jobs building the same version of the same
    # package.
    packaging_sleep: 0
